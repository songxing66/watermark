!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).watermark=e()}(this,(function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function a(t,e){return t(e={exports:{}},e.exports),e.exports}var n=a((function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),o=a((function(t){var e=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=e)})),i=(o.version,function(t){return"object"==typeof t?null!==t:"function"==typeof t}),s=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t},l=function(t){try{return!!t()}catch(t){return!0}},c=!l((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),u=n.document,m=i(u)&&i(u.createElement),f=!c&&!l((function(){return 7!=Object.defineProperty((t="div",m?u.createElement(t):{}),"a",{get:function(){return 7}}).a;var t})),w=Object.defineProperty,_={f:c?Object.defineProperty:function(t,e,r){if(s(t),e=function(t,e){if(!i(t))return t;var r,a;if(e&&"function"==typeof(r=t.toString)&&!i(a=r.call(t)))return a;if("function"==typeof(r=t.valueOf)&&!i(a=r.call(t)))return a;if(!e&&"function"==typeof(r=t.toString)&&!i(a=r.call(t)))return a;throw TypeError("Can't convert object to primitive value")}(e,!0),s(r),f)try{return w(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},d=c?function(t,e,r){return _.f(t,e,function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}(1,r))}:function(t,e,r){return t[e]=r,t},h={}.hasOwnProperty,p=function(t,e){return h.call(t,e)},k=0,y=Math.random(),v=a((function(t){var e=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(t.exports=function(t,r){return e[t]||(e[t]=void 0!==r?r:{})})("versions",[]).push({version:o.version,mode:"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})}))("native-function-to-string",Function.toString),b=a((function(t){var e,r="Symbol(".concat(void 0===(e="src")?"":e,")_",(++k+y).toString(36)),a=(""+v).split("toString");o.inspectSource=function(t){return v.call(t)},(t.exports=function(t,e,o,i){var s="function"==typeof o;s&&(p(o,"name")||d(o,"name",e)),t[e]!==o&&(s&&(p(o,r)||d(o,r,t[e]?""+t[e]:a.join(String(e)))),t===n?t[e]=o:i?t[e]?t[e]=o:d(t,e,o):(delete t[e],d(t,e,o)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[r]||v.call(this)}))})),g=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},x=function(t,e,r){if(g(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,a){return t.call(e,r,a)};case 3:return function(r,a,n){return t.call(e,r,a,n)}}return function(){return t.apply(e,arguments)}},S=function(t,e,r){var a,i,s,l,c=t&S.F,u=t&S.G,m=t&S.S,f=t&S.P,w=t&S.B,_=u?n:m?n[e]||(n[e]={}):(n[e]||{}).prototype,h=u?o:o[e]||(o[e]={}),p=h.prototype||(h.prototype={});for(a in u&&(r=e),r)s=((i=!c&&_&&void 0!==_[a])?_:r)[a],l=w&&i?x(s,n):f&&"function"==typeof s?x(Function.call,s):s,_&&b(_,a,s,t&S.U),h[a]!=s&&d(h,a,l),f&&p[a]!=s&&(p[a]=s)};n.core=o,S.F=1,S.G=2,S.S=4,S.P=8,S.B=16,S.W=32,S.U=64,S.R=128;var M=S,j=function(t,e,r){var a=void 0===r;switch(e.length){case 0:return a?t():t.call(r);case 1:return a?t(e[0]):t.call(r,e[0]);case 2:return a?t(e[0],e[1]):t.call(r,e[0],e[1]);case 3:return a?t(e[0],e[1],e[2]):t.call(r,e[0],e[1],e[2]);case 4:return a?t(e[0],e[1],e[2],e[3]):t.call(r,e[0],e[1],e[2],e[3])}return t.apply(r,e)},E=[].slice,F={},T=function(t,e,r){if(!(e in F)){for(var a=[],n=0;n<e;n++)a[n]="a["+n+"]";F[e]=Function("F,a","return new F("+a.join(",")+")")}return F[e](t,r)},O=Function.bind||function(t){var e=g(this),r=E.call(arguments,1),a=function(){var n=r.concat(E.call(arguments));return this instanceof a?T(e,n.length,n):j(e,n,t)};return i(e.prototype)&&(a.prototype=e.prototype),a};function P(t){var e=document.createElement("div");return e.id=t||"",e.setAttribute("style","pointer-events: none !important; display: block !important"),e}return M(M.P,"Function",{bind:O}),function(){function a(t){e(this,a),this.defaultSettings={watermark_id:"wm_div_id",watermark_prefix:"mask_div_id",watermark_txt:"测试水印",watermark_x:20,watermark_y:20,watermark_rows:0,watermark_cols:0,watermark_x_space:50,watermark_y_space:50,watermark_font:"微软雅黑",watermark_color:"black",watermark_fontsize:"18px",watermark_alpha:.15,watermark_width:100,watermark_height:100,watermark_angle:15,watermark_parent_width:0,watermark_parent_height:0,watermark_parent_node:null,monitor:!0};var r=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;this.watermarkDom=new r(this.callback.bind(this)),this.globalSetting=null,this.option={childList:!0,attributes:!0,subtree:!0},this.otdiv=null,this.bindsome=null,this.init.apply(this,arguments)}var n,o,i;return n=a,(o=[{key:"_loadMark",value:function(e){var r=this.defaultSettings;if(1===arguments.length&&"object"===t(arguments[0])){var a=arguments[0]||{};for(var n in a)a[n]&&r[n]&&a[n]===r[n]||(a[n]||0===a[n])&&(r[n]=a[n])}var o=this.otdiv;o&&o.parentNode&&(o.parentNode.removeChild(o),this.otdiv=null);var i=document.getElementById(r.watermark_parent_node),s=i||document.body,l=Math.max(s.scrollWidth,s.clientWidth),c=Math.max(s.scrollHeight,s.clientHeight),u=arguments[0]||{},m=s,f=0,w=0;u.watermark_parent_width||u.watermark_parent_height?m&&(f=m.offsetTop||0,w=m.offsetLeft||0,r.watermark_x=r.watermark_x+w,r.watermark_y=r.watermark_y+f):m&&(f=m.offsetTop||0,w=m.offsetLeft||0);var _=this.otdiv,d=null;if(_)_.shadowRoot&&(d=_.shadowRoot);else{d="function"==typeof(_=P(r.id||"")).attachShadow?_.attachShadow({mode:"open"}):_,this.otdiv=_;var h=s.children,p=Math.floor(Math.random()*(h.length-1));h[p]?s.insertBefore(_,h[p]):s.appendChild(_)}r.watermark_cols=parseInt((l-r.watermark_x)/(r.watermark_width+r.watermark_x_space));var k,y=parseInt((l-r.watermark_x-r.watermark_width*r.watermark_cols)/r.watermark_cols);r.watermark_x_space=y?r.watermark_x_space:y,r.watermark_rows=parseInt((c-r.watermark_y)/(r.watermark_height+r.watermark_y_space));var v,b,g,x=parseInt((c-r.watermark_y-r.watermark_height*r.watermark_rows)/r.watermark_rows);r.watermark_y_space=x?r.watermark_y_space:x,i?(k=r.watermark_x+r.watermark_width*r.watermark_cols+r.watermark_x_space*(r.watermark_cols-1),v=r.watermark_y+r.watermark_height*r.watermark_rows+r.watermark_y_space*(r.watermark_rows-1)):(k=w+r.watermark_x+r.watermark_width*r.watermark_cols+r.watermark_x_space*(r.watermark_cols-1),v=f+r.watermark_y+r.watermark_height*r.watermark_rows+r.watermark_y_space*(r.watermark_rows-1));for(var S=0;S<r.watermark_rows;S++){g=i?f+r.watermark_y+(c-v)/2+(r.watermark_y_space+r.watermark_height)*S:r.watermark_y+(c-v)/2+(r.watermark_y_space+r.watermark_height)*S;for(var M=0;M<r.watermark_cols;M++){b=i?w+r.watermark_x+(l-k)/2+(r.watermark_width+r.watermark_x_space)*M:r.watermark_x+(l-k)/2+(r.watermark_width+r.watermark_x_space)*M;var j=document.createElement("div"),E=document.createTextNode(r.watermark_txt);j.appendChild(E),j.id=r.watermark_prefix+S+M,j.style.webkitTransform="rotate(-"+r.watermark_angle+"deg)",j.style.MozTransform="rotate(-"+r.watermark_angle+"deg)",j.style.msTransform="rotate(-"+r.watermark_angle+"deg)",j.style.OTransform="rotate(-"+r.watermark_angle+"deg)",j.style.transform="rotate(-"+r.watermark_angle+"deg)",j.style.visibility="",j.style.position="absolute",j.style.left=b+"px",j.style.top=g+"px",j.style.overflow="hidden",j.style.zIndex="5",j.style.opacity=r.watermark_alpha,j.style.fontSize=r.watermark_fontsize,j.style.fontFamily=r.watermark_font,j.style.color=r.watermark_color,j.style.textAlign="center",j.style.width=r.watermark_width+"px",j.style.height=r.watermark_height+"px",j.style.display="block",j.style["-ms-user-select"]="none",d.appendChild(j)}}var F=void 0===e.monitor?r.monitor:e.monitor;F&&(this.watermarkDom.observe(s,this.option),this.watermarkDom.observe(_.shadowRoot,this.option))}},{key:"_removeMark",value:function(){var e=this.defaultSettings;if(1===arguments.length&&"object"===t(arguments[0])){var r=arguments[0]||{};for(var a in r)r[a]&&e[a]&&r[a]===e[a]||(r[a]||0===r[a])&&(e[a]=r[a])}var n=this.otdiv,o=n.parentNode;o.removeChild(n),this.otdiv=null}},{key:"init",value:function(t){this.globalSetting=t,this._loadMark(t),this.bindsome=this._ListenerCallback.bind(this),window.addEventListener("onload",this.bindsome),window.addEventListener("resize",this.bindsome)}},{key:"destroy",value:function(){this.watermarkDom.disconnect(),window.removeEventListener("onload",this.bindsome),window.removeEventListener("resize",this.bindsome),this._removeMark()}},{key:"_ListenerCallback",value:function(){var t=this.globalSetting;this._loadMark(t)}},{key:"load",value:function(t){this._loadMark(t)}},{key:"remove",value:function(){this.watermarkDom.disconnect(),this._removeMark()}},{key:"callback",value:function(t){var e=this.globalSetting;(e&&1===t.length||1===t.length&&t[0].removedNodes.length>=1)&&this._loadMark(e)}}])&&r(n.prototype,o),i&&r(n,i),a}()}));
